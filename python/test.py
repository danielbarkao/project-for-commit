'''

https://www.google.com/#
id_token=eyJraWQiOiJBRG1EdW0xMWcrQmQ2dU5qOUFDdEVDNGpqZnlaZGlCYUh0NUM0d3J4cURrPSIsImFsZyI6IlJTMjU2In0.eyJhdF9oYXNoIjoiZy1kNGVnYmwydkhxMnZ6di1PV1RMdyIsInN1YiI6IjE3YzQ0NzEyLTM2MGQtNGRmMS1iM2ZmLWZlNDgzNmMxZDAzNSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAudXMtZWFzdC0xLmFtYXpvbmF3cy5jb21cL3VzLWVhc3QtMV9RTTg1WFJKSXoiLCJjb2duaXRvOnVzZXJuYW1lIjoiMTdjNDQ3MTItMzYwZC00ZGYxLWIzZmYtZmU0ODM2YzFkMDM1IiwiYXVkIjoiM3RtOXJuZDZoNGZwaWhidWZ2NXRobXU2NW8iLCJldmVudF9pZCI6IjdmMzEzMzc4LWU1ZmUtNDNiMy05MDQ5LTZkMjM5NTc2Mjc5MiIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjg5ODg0MzUzLCJleHAiOjE2ODk4ODc5NTMsImlhdCI6MTY4OTg4NDM1MywianRpIjoiYTk3MWRkYmItYWE5OC00MTM2LTgyYjAtOTY4Nzk5YTRkNzJkIiwiZW1haWwiOiJtaXNnYXY3NzdAZ21haWwuY29tIn0.HVSh0QAPf4MuFqBgqKa-Z71SAeM3JrVDaD56_Y0_R0g6IAiSJv5az_OC-Czpa6OkW4UNYG9r71e2cldsc-PWFmrN_j1du2fZ91YHkvQayhrplrG2Ez_rOOdjE2bNPHtN5P6D94J5R45QUrCCSld8-66OpiYVpDhDgFRdkIZyEHSZvGQ76Fx8evkGLBL64grq7kIJJcjHz7O5r319sTwz1_sd4bHV5gxippgfgniR1ZJtOE02R5RM_o3bBlSgmz4N7K-xdKg0fiAKOZ-x7Z9TJX8pmwCmCRqWYtiEHQ3D_VjHOBy-QrUG0soy_kdWtCyKLEv7cMsVixVhtwLPkfoVzA

&access_token=eyJraWQiOiJDRTBuOVlTNXNpU05VS1QwZ1wvenJabEM1UmUwbUVXMWx3NGdtV1BQSVBXYz0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIxN2M0NDcxMi0zNjBkLTRkZjEtYjNmZi1mZTQ4MzZjMWQwMzUiLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAudXMtZWFzdC0xLmFtYXpvbmF3cy5jb21cL3VzLWVhc3QtMV9RTTg1WFJKSXoiLCJ2ZXJzaW9uIjoyLCJjbGllbnRfaWQiOiIzdG05cm5kNmg0ZnBpaGJ1ZnY1dGhtdTY1byIsImV2ZW50X2lkIjoiN2YzMTMzNzgtZTVmZS00M2IzLTkwNDktNmQyMzk1NzYyNzkyIiwidG9rZW5fdXNlIjoiYWNjZXNzIiwic2NvcGUiOiJwaG9uZSBvcGVuaWQgcHJvZmlsZSBlbWFpbCIsImF1dGhfdGltZSI6MTY4OTg4NDM1MywiZXhwIjoxNjg5ODg3OTUzLCJpYXQiOjE2ODk4ODQzNTMsImp0aSI6ImVkNmMxMWE1LWE0MDktNDA5OS04MjFhLTYyYzY1ZDI3ZGQ3NCIsInVzZXJuYW1lIjoiMTdjNDQ3MTItMzYwZC00ZGYxLWIzZmYtZmU0ODM2YzFkMDM1In0.jrAS_QPRo2MkbjS7-km1o1NYCAGuDV_SDhZ5JsGHWE5IIt3IND5VdK3n2hyINbG1pq27-z_I48c7xvMArqVKYsgZBBceVjcZpWVIMyZeh6MSxXZra60ofq5O-Xe4XTbgfTIRYnuwvI8nxcE9NkR7oxF0rcsixdydhnIfjtF8oPGq_Qz5-iVqhVGoN83HOeu77vmLBQi5hrdXzV0FKb05D_K43mMGD_zBFbLo8RStTmoa5KkFsOw0k4MJOAbmDlqBf8QBeVYJLsV7lpWOGkJFk92ldFX1ijNA4H_Cp9m5CehppLvqNqn3DYY0Kq1RNhtRxxjY-T13sQl3LoSAqLfyUg

&expires_in=3600
&token_type=Bearer

'''


import json
import boto3
import time

# Initialize AWS clients
cognito_client = boto3.client('cognito-idp')
dynamodb_client = boto3.client('dynamodb')
ssm_client = boto3.client('ssm')

# up_parameter = ssm_client.get_parameter(
#     Name='userpool_id', WithDecryption=True)

dynamodb_parameter = ssm_client.get_parameter(
    Name='dynamodb_table_name', WithDecryption=True)

user_pool_id = 'us-east-1_s864qwvc1'

# user_pool_id = up_parameter['Parameter']['Value']
dynamodb_table_name = dynamodb_parameter['Parameter']['Value']

# Process extraction the required data
response = cognito_client.list_users(
    UserPoolId=user_pool_id
)
# print(response)
for user in response['Users']:
    email = None
    creation_time = None
    # print(user)
    for attr in user['Attributes']:
        if attr['Name'] == 'email':
            email = attr['Value']
            break
            # print(email)
creation_time = str(response['Users'][0]['UserCreateDate'])


table = 'UsersDataTable'
dynamodb_client.put_item(
    TableName=table,
    Item={
        'username': {'S': email},
        'creation_time': {'S': creation_time},
        'hello': {'N': '99999'}
    }
)

# print(response)


'''

https://www.google.com/#id_token=eyJraWQiOiJMTVVQTEhWdURFbjNTaTd2UUFkV29uTXN6VHdSNm9jUFpEMXVwaEJ2MVZvPSIsImFsZyI6IlJTMjU2In0.eyJhdF9oYXNoIjoiTEkzeVZzSlR3WHN5S19LQkpnM21ZQSIsInN1YiI6ImY0Mzg2NDg4LWMwMTEtNzA5MS02YTY4LWY2YzhiMDJjNGU0NSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAudXMtZWFzdC0xLmFtYXpvbmF3cy5jb21cL3VzLWVhc3QtMV9zODY0cXd2YzEiLCJjb2duaXRvOnVzZXJuYW1lIjoibWlzZ2F2IiwiYXVkIjoiNW45cXJnY3U2dWwzNTBqMjZmMGdsMmg2bWsiLCJldmVudF9pZCI6IjIyYzQxOGJlLWJmNzktNDk5YS1iMzQ2LWZjYzZkMTYzYjc3OCIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjkwMTEzMjUwLCJleHAiOjE2OTAxMTY4NTAsImlhdCI6MTY5MDExMzI1MCwianRpIjoiMTI4MTk1YzAtYWNiMS00M2ZhLWEyM2EtMDZjMzlmYTY1NWY5IiwiZW1haWwiOiJtaXNnYXY3NzdAZ21haWwuY29tIn0.YsINih-s_amHD2VaTpX2BmiDGdmZVtFZ6noHPbuyXYsHlcB_mF-7CLeJ4aaG1BRDJ_Wp_I7XRUuKMVdl2nOhBz5SFqO5EtStVMbBgUAWAMFQaUFSTsNe82M5M_TdarcbBm1SaKFcSuQ5h6CQjCxrRaYOpszKFc9v8J3_WXNS-InFepIZCTcdGCiqghtnphmcH2s0LsjiKIg1-yl6F32_3iLjUcbhh2ure7KMAH7n01vEwbVyf8Q-CWSoyCdq6DtuuN4mJUsA8WcEezeJqtlsQTtWFlr6XTY4GjoXYEQRRGDB6BkXDuXzj0do6TMdDen_yWzbuqQSIt2aDn7igbIaKw&access_token=eyJraWQiOiJOckZTUnVSazk2bzU5R1ZCZmVJWG1JQjR4QVErUmdBb0Y4bGJaVVRqS3BZPSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiJmNDM4NjQ4OC1jMDExLTcwOTEtNmE2OC1mNmM4YjAyYzRlNDUiLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAudXMtZWFzdC0xLmFtYXpvbmF3cy5jb21cL3VzLWVhc3QtMV9zODY0cXd2YzEiLCJ2ZXJzaW9uIjoyLCJjbGllbnRfaWQiOiI1bjlxcmdjdTZ1bDM1MGoyNmYwZ2wyaDZtayIsImV2ZW50X2lkIjoiMjJjNDE4YmUtYmY3OS00OTlhLWIzNDYtZmNjNmQxNjNiNzc4IiwidG9rZW5fdXNlIjoiYWNjZXNzIiwic2NvcGUiOiJwaG9uZSBvcGVuaWQgZW1haWwiLCJhdXRoX3RpbWUiOjE2OTAxMTMyNTAsImV4cCI6MTY5MDExNjg1MCwiaWF0IjoxNjkwMTEzMjUwLCJqdGkiOiI4MzYzMzQ5Ny00MGRiLTRmMmYtYmZlMy1lN2NiOTBmMGY5YWUiLCJ1c2VybmFtZSI6Im1pc2dhdiJ9.KW7BDZtl0OYJoVrPAULTdKfz1Hb85p948ArXzxfmwoOfvkpcR3g3M8HjOxNL087XA07CjlD3Fyyl7FM29R1fOzxk-M4TUmeTFJGS9CnrLC3kl5o0ek52T2z2doCuXe8KAfWp8VR6gqmnK2TBv-MA7wsRaZT-kKSBwI3wC3fHdDXDSqJOpcuveQlPNXFeYBWJP_QamuwIRYZJVoxZ7IfSXShZ6zCxc5Eoc8pe6Fw_mmExzRDfJxBF3lLl2_bqB5t8iqXp4HgIeOJ5Z4wH5AyrKECvzqyeSQl5mmPadv6ixexDHhGItD9e8OxuVB7Kk5jo4y6Rcib6bNGFp9EHbJckHg&expires_in=3600&token_type=Bearer
'''
